<div class="page-wrapper">
  <!-- Page Header -->
  <div class="page-header d-print-none">
    <div class="container-xl">
      <div class="row g-2 align-items-center">
        <div class="col">
          <div class="page-pretitle">Admin</div>
          <h2 class="page-title">{{ $._title }}</h2>
        </div>
      </div>
    </div>
  </div>

  <!-- Page Body -->
  <div class="page-body">
    <div class="container-xl">
      <div class="row row-deck row-cards">

        <!-- TODO: accordion for filters -->
        <!-- Form - Filters -->
        <div class="col-12">
          <form id="filters" class="card">
            <div class="card-header py-3">
              <h3 class="card-title">Filters</h3>
            </div>

            <div class="card-body py-3">
              <div class="row">
                <div class="col-3">
                  <div class="mb-3">
                    <label for="username" class="form-label">Username</label>
                    <input id="username" class="form-control"
                        type="text" placeholder="username" 
                        name="username" value="{{ $._datatable.user_listing.filter.username }}">
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-2">
                  <div class="mb-3">
                    <label for="role_simple" class="form-label">Role</label>
                    <select id="role_simple" class="form-select"
                        name="role_simple">
                      <option value="" {{ if eq $._datatable.user_listing.filter.role_simple "" }}selected{{ end }}>All</option>
                      <option value="admin" {{ if eq $._datatable.user_listing.filter.role_simple "admin" }}selected{{ end }}>Admin</option>
                      <option value="operator" {{ if eq $._datatable.user_listing.filter.role_simple "operator" }}selected{{ end }}>Operator</option>
                      <option value="viewer" {{ if eq $._datatable.user_listing.filter.role_simple "viewer" }}selected{{ end }}>Viewer</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>

            <div class="card-footer py-3 d-flex">
              <div>
                <button class="btn btn-primary"
                    title="Search" data-bs-toggle="tooltip" data-bs-placement="top"
                    type="submit" formmethod="get" formaction="">
                  <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-search"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" /><path d="M21 21l-6 -6" /></svg>
                  Search
                </button>
                <a class="btn" tabindex="-1"
                    title="Reset filters" data-bs-toggle="tooltip" data-bs-placement="top"
                    href="{{ $._link.user_listing }}">
                  Reset Filters
                </a>
              </div>
              <div class="ms-auto">
              </div>
            </div>
          </form>
        </div>

        <!-- datatable -->
        <div class="col-12">
          <div class="card">
            <div class="card-header py-3">
              <h3 class="card-title">Users</h3>
              <div class="ms-auto">
                <a class="btn btn-primary"
                    title="Add new item" data-bs-toggle="tooltip" data-bs-placement="top"
                    href="{{ $._link.new_user }}">
                  <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-plus"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 5l0 14" /><path d="M5 12l14 0" /></svg>
                  Add new item
                </a>
              </div>
            </div>
            <div class="table-responsive">
              <table id="datatable" class="table card-table table-vcenter">
                <thead>
                  <tr>
                    <th class="text-nowrap">Username</th>
                    <th class="text-nowrap">Role</th>

                    <th class="text-nowrap">Actions</th>
                  </tr>
                </thead>
                <tbody>
                  {{ if $._datatable.user_listing.rows }}
                  {{ range $idx, $item := $._datatable.user_listing.rows }}
                  <tr>
                    <td>{{ $item.username }}</td>
                    <td>{{ $item.role_simple }}</td>

                    <td>
                      <div class="btn-list" style="--tblr-list-gap: 0.2rem;">
                        <a class="btn btn-primary btn-icon"
                            data-bs-toggle="tooltip" data-bs-placement="top" title="Edit User"
                            href="{{ $item.link_detail }}">
                          <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-pencil"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" /><path d="M13.5 6.5l4 4" /></svg>
                        </a>
                      </div>
                    </td>
                  </tr>
                  {{ end }}
                  {{ end }}
                </tbody>
              </table>
            </div>

            <div class="card-footer py-3 d-flex align-items-center">
              <span style="padding-right: 8px;">Showing</span>
              <select id="perpage" class="form-select" style="width: 80px; padding: 8px 0 8px 8px;">
                <option value="10">10</option>
                <option value="20">20</option>
                <option value="50">50</option>
                <option value="100">100</option>
              </select>
              {{ if $._datatable.user_listing.pg }}
              <span style="padding-left: 8px;">out of {{ $._datatable.user_listing.pg.TotalData }} data</span>
              {{ else }}
              <span style="padding-left: 8px;">out of _ data</span>
              {{ end }}

              {{ if $._datatable.user_listing.pg }}
              <ul class="pagination m-0 ms-auto">
                <li class="page-item">
                  <a class="page-link" tabindex="-1" href="{{ $._datatable.user_listing.pg.FirstLink.Link }}">
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-chevrons-left"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M11 7l-5 5l5 5" /><path d="M17 7l-5 5l5 5" /></svg>
                  </a>
                </li>
                <li class="page-item" style="margin-right: 8px;">
                  <a class="page-link" tabindex="-1" href="{{ $._datatable.user_listing.pg.PrevLink.Link }}">
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-chevron-left"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M15 6l-6 6l6 6" /></svg>
                  </a>
                </li>

                {{ range $midIdx, $midLink := $._datatable.user_listing.pg.MidLinks }}
                <li class="page-item {{ if $midLink.IsActive }}active{{ end }}">
                  <a class="page-link" tabindex="-1" href="{{ $midLink.Link }}">{{ $midLink.Name }}</a>
                </li>
                {{ end }}

                <li class="page-item" style="margin-left: 8px;">
                  <a class="page-link" tabindex="-1" href="{{ $._datatable.user_listing.pg.NextLink.Link }}">
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-chevron-right"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 6l6 6l-6 6" /></svg>
                  </a>
                </li>
                <li class="page-item">
                  <a class="page-link" tabindex="-1" href="{{ $._datatable.user_listing.pg.LastLink.Link }}">
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-chevrons-right"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7l5 5l-5 5" /><path d="M13 7l5 5l-5 5" /></svg>
                  </a>
                </li>
              </ul>
              {{ end }}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function(e) {
    nsMain.focusOn('username');
  });
</script>
